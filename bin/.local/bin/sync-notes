#!/bin/bash

CYAN='\033[0;36m'
NC='\033[0m'

print_usage() {
  echo "Usage: $0 <up|down|dry> [file]"
  echo "  up:    Send notes to server"
  echo "  down:  Grab notes from server"
  echo "  dry:   Dry run sending and grabbing"
  echo "  file:  Optional file"
}

FILE=""
# Check if file is specified
if [ -n "$2" ]; then
  echo "Argument given: $2"
  # Strip file of leading directory up to notes
  FILE="/${2#*notes/}"
  echo "File: $FILE"
fi

case $1 in
  "up")
    echo -e "${CYAN}Sending notes$FILE to server...${NC}"
    rsync -avzuP --delete ~/notes/$FILE admin@smtucker.dev:~/notes$FILE
    ;;
  "down")
    echo -e "${CYAN}Grabing notes$FILE from server...${NC}"
    rsync -avzuP --delete admin@smtucker.dev:~/notes/$FILE ~/notes$FILE
    ;;
  "dry")
    echo -e "\n${CYAN}Dry run sending notes$FILE ...${NC}\n"
    rsync -avznu --stats --delete ~/notes/$FILE admin@smtucker.dev:~/notes$FILE
    echo -e "\n\n${CYAN}Dry run grabbing notes$FILE...\n${NC}"
    rsync -avznu --stats --delete admin@smtucker.dev:~/notes/$FILE ~/notes$FILE
    ;;
  *)
    echo "Unknown option: $1"
    print_usage
    ;;
esac

